name: Deploy to Somee.com via FTP

on:
  push:
    # Kích hoạt workflow khi có push lên nhánh 'main'
    branches:
      - main
  # Cho phép chạy workflow thủ công từ giao diện GitHub
  workflow_dispatch:

jobs:
  deploy:
    # Chạy trên môi trường Ubuntu mới nhất (có sẵn lftp)
    runs-on: ubuntu-latest
    
    steps:
      # 1. Checkout mã nguồn
      - name: Checkout Repository
        uses: actions/checkout@v4

      # 2. Triển khai qua lftp Shell Command
      - name: Deploy to Somee.com via lftp
        run: |
          # Bắt đầu lệnh lftp (Sử dụng -c để thực hiện chuỗi lệnh)
          # open -u [username],[password] [host]
          # mirror -R: Đồng bộ hóa (upload) từ thư mục cục bộ sang thư mục remote
          # ./ : Thư mục nguồn cục bộ (root của repo)
          # /www.hoangquocdat.somee.com/ : Thư mục đích trên Somee.com
          lftp -c "open -u ${{ secrets.FTP_USER }},${{ secrets.FTP_PW }} ${{ secrets.FTP_HOST }}; \
          mirror -R \
          --delete \
          ./ \
          /www.hoangquocdat.somee.com/"
