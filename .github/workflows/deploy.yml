name: Deploy to Somee.com via FTP

on:
  push:
    # Kích hoạt workflow khi có push lên nhánh 'main'
    branches:
      - main
  # Cho phép chạy workflow thủ công từ giao diện GitHub
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      # 1. Checkout mã nguồn
      - name: Checkout Repository
        uses: actions/checkout@v4

      # 2. Triển khai qua FTP (Sử dụng Mosh-Dev/ftp-action)
      - name: Deploy to Somee.com
        # Sử dụng Action Mosh-Dev/ftp-action - Đã được chứng minh là ổn định hơn trong các trường hợp tải Action lỗi
        uses: Mosh-Dev/ftp-action@main 
        with:
          # Địa chỉ máy chủ FTP
          host: ${{ secrets.FTP_HOST }}
          # Tên người dùng FTP
          username: ${{ secrets.FTP_USER }}
          # Mật khẩu FTP
          password: ${{ secrets.FTP_PW }}
          
          # Thư mục gốc trong repo GitHub chứa các file cần upload (ví dụ: index.html)
          source: ./ 
          
          # Thư mục đích trên máy chủ Somee.com
          # ĐÃ SỬA: Trỏ đúng vào thư mục tên miền của bạn để index.html được truy cập
          target: /www.hoangquocdat.somee.com/ 
          
          # Đảm bảo kết nối an toàn (khuyến nghị cho các dịch vụ hosting hiện đại)
          ftps: true
          
          # (Tùy chọn) Xóa các tệp không tồn tại trong thư mục cục bộ khỏi máy chủ
          delete: false
